<head>
  <title>The HouseSitter</title>
</head>

<body>
  <h1>The House-Sitter App</h1>
  {{> selectHouse}}
  {{> showHouse}}
  {{> houseForm}}
</body>

<template name='selectHouse'>
  <select id='selectHouse'>
    <!-- Begin the list with an empty option to select -->
    <option value='' {{ isSelected }}></option>

    <!-- 'Each' iterates over all objects returned by a helper called houseNameId -->
    {{#each houseNameId}}
      <option value='{{_id}}' {{ isSelected }}>{{name}}</option>}
    {{/each}}
  </select>
</template>

<template name='showHouse'>
  <!-- Setting the data context for the template explicity -->
  {{#with selectedHouse}}
    <!-- Each database field is a property of the house object and can be accessed using dot notation -->
    <h2>Taking care of {{name}}'s house</h2>
    <p>Last visit: {{lastvisit}}</p>

    <!-- 'each' further narrows the data context for the subtemplate -->
    {{#each plants}}
      <!-- A subtemplate, 'plantDetails', is included -->
      {{> plantDetails}}
    {{/each}}
    <button id='delete'>Delete this house</button>
    {{else}}
      You need to select a house.
  {{/with}}
  <hr>
</template>

<template name='plantDetails'>
  <p>
    <strong>Plant color:</strong> {{color}}
  </p>
  <p>
    <strong>Instructions:</strong> {{instructions}}
    <!-- ../id = context from parent node 'showHouse' -->
    <button class='water' data-id='{{../_id}}-{{color}}' {{isWatered}}> 
      Done
    </button>
  </p>
</template>

<template name='houseForm'>
  <!-- Set the data context using the global helper -->
  {{#with selectedHouse}}
    <!-- Change the generic heading to mention the name -->
    <h3>Edit {{name}}'sa house</h3>
    <form id='houseForm'>
      <!-- fieldsets group plant inputs -->
      <fieldset id='house-name'>
        <!-- Existing data is assigned to value attributes -->
        Name <input id='house-name' class='name' type='text' placeholder='Name' value='{{name}}' /><br/>
      </fieldset>
      <label>Plants</label>
        {{#each withIndex plants}}
          {{> plantFieldset}}
        {{/each}}

        <button class='addPlant'>Add Plant</button>
        <br />
        <button id='save-house' data-id='{{_id}}'>Save House</button>      
    </form>
  {{/with}}
</template>

<template name='plantFieldset'>
  <fieldset>
    Color <input class='color' type='text' value='{{color}}' data-index='{{index}}'>
    <!-- Existing data is assigned to vlaue attributes -->
    Instructions <input class='instructions' type='text' value='{{instructions}}' data-index='{{index}}'>
    <button class='removePlant' data-index='{{index}}'>Remove Plant</button>
  </fieldset>
</template>